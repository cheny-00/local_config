# Caddy S3 反代保护配置
# 复制到 /etc/fail2ban/jail.d/caddy-s3.conf
# 需要先复制 filter: fail2ban/filter.d/caddy-s3.conf

[caddy-s3]
enabled = true
port = http,https,8333
filter = caddy-s3
action = iptables-allports[name=caddy-s3]
         discord-webhook[webhook_url="YOUR_DISCORD_WEBHOOK_URL"]

# Caddy 访问日志路径（根据实际情况修改）
logpath = /var/log/caddy/s3-access.log
# 或者使用 Caddy 默认日志
# logpath = /var/log/caddy/access.log

# 严格配置（S3 API 认证失败应该很少）
maxretry = 3       # 3 次失败即封禁
bantime = 14400    # 封禁 4 小时
findtime = 3600    # 1 小时内

# 如果遇到频繁误封，可以放宽：
# maxretry = 5
# bantime = 3600
# findtime = 1800
